<!-- begin toolbar -->
<div class="afb-toolbar noselect">

  &nbsp;&nbsp;

  <!--Choose a Collection-->
  <span
    *ngIf="!selectedCollection"
    (click)="onCollectionsClick()"
    class="noselect">
      
      <u>Choose a collection</u>

  </span>

  <ng-container *ngIf="selectedCollection">

    &nbsp;&nbsp;&nbsp;

    <!-- collection name -->
    <span
      class="label selectable"
      style="font-style: underline;"
      (click)="onCollectionsClick()">
      
        <u>{{selectedCollection.name}}</u>
      
    </span>

    &nbsp;

    <!--Info Tooltip Icon-->
    <span
      class="collectionTooltip"
      *ngIf="selectedCollection"
      [pTooltip]="infoTooltipText"
      tooltipPosition="bottom"
      tooltipStyleClass="collectionTooltip"
      class="fa fa-info-circle fa-lg fa-fw">
    </span>

    <!-- Edit Icon -->
    <span
      *ngIf="selectedCollection.type != 'fixed'"
      pTooltip="Edit collection"
      class="fa fa-pencil-square-o fa-lg fa-fw"
      (click)="onEditCollectionClick()">
    </span>

    <span
      *ngIf="selectedCollection.type == 'fixed'"
      pTooltip="Reprocess collection"
      class="fa fa-repeat fa-lg fa-fw"
      (click)="onEditCollectionClick()">
    </span>

    <!--State Icons-->
    <span
      *ngIf="spinnerIcon"
      class="fa fa-refresh fa-spin fa-lg fa-fw"
      pTooltip="Building collection">
    </span>

    <span
      *ngIf="errorIcon"
      class="fa fa-exclamation-triangle fa-lg fa-fw"
      style="color: yellow;"
      [pTooltip]="errorMessage">
    </span>

    <span
      *ngIf="queryingIcon && selectedCollection.serviceType == 'nw'"
      class="fa fa-question fa-spin fa-lg fa-fw"
      pTooltip="Querying NetWitness data">
    </span>

    <span
      *ngIf="queryingIcon && selectedCollection.serviceType == 'sa'"
      class="fa fa-question fa-spin fa-lg fa-fw"
      pTooltip="Querying Security Analytics data">
    </span>

    <span
      *ngIf="queryResultsCount == 0 && selectedCollection.state == 'complete' && contentCount.total == 0"
      class="fa fa-ban fa-lg fa-fw"
      style="color: red;"
      pTooltip="0 results were returned from the query">
    </span>

    <span
      *ngIf="queryResultsCount == 0 && selectedCollection.state == 'resting' && contentCount.total == 0"
      class="fa fa-ban fa-lg fa-fw"
      pTooltip="0 results were returned from the latest query">
    </span>

    <span *ngIf="workerProgress != null">
      {{workerLabel}}: {{workerProgress}}&nbsp;&nbsp;
    </span>

    <!--Collection Type -->
    <span class="label selectable"> 
      {{selectedCollection.type | capFirstLetter}} Collection&nbsp;&nbsp;
    </span>

    <!-- Collection Time -->
    <span
      *ngIf="selectedCollection.type == 'rolling'"
      class="label">
        Last {{selectedCollection.lastHours}} Hours&nbsp;&nbsp;
    </span>
    
    <span
      *ngIf="selectedCollection.type == 'fixed'"
      class="label">Begin: 
    </span>
    
    <span
      *ngIf="selectedCollection.type == 'fixed'"
      class="value selectable">
        {{selectedCollection.timeBegin | formatTime}}
    </span>
    
    &nbsp;

    <span
      *ngIf="selectedCollection.type == 'fixed'"
      class="label">
        End: 
    </span>
    
    <span
      *ngIf="selectedCollection.type == 'fixed'"
      class="value selectable">
        {{selectedCollection.timeEnd | formatTime}}
    </span>

  </ng-container>


  <!--Mask & Search Buttons-->
  <span style="float: right;">

    <ng-container *ngIf="selectedCollection">

      <!-- image mask-->
      <span
        *ngIf="contentCount.images != 0 && (contentCount.pdfs != 0 || contentCount.excel != 0 || contentCount.powerpoint != 0 || contentCount.word != 0 || contentCount.dodgyArchives != 0 || contentCount.hashes != 0)"
        [class.fa-deselect]="!showImages"
        [class.hide]="showSearch"
        (click)="maskClick('image')"
        class="fa fa-file-image-o fa-lg"
        pTooltip="Mask for image content"
        escape="false"
        showDelay="750"
        tooltipPosition="bottom">
          &nbsp;
      </span>

      <!-- pdf mask -->
      <span
        *ngIf="contentCount.pdfs != 0 && (contentCount.images != 0 || contentCount.excel != 0 || contentCount.powerpoint != 0 || contentCount.word != 0 || contentCount.dodgyArchives != 0 || contentCount.hashes != 0)"
        [class.fa-deselect]="!showPdfs"
        [class.hide]="showSearch"
        (click)="maskClick('pdf')"
        class="fa fa-file-pdf-o fa-lg"
        pTooltip="Mask for PDF content"
        escape="false"
        showDelay="750"
        tooltipPosition="bottom">
          &nbsp;
      </span>

      <!-- word mask -->
      <span
        *ngIf="contentCount.word != 0 && (contentCount.excel != 0 || contentCount.powerpoint != 0 || contentCount.images != 0 || contentCount.pdfs != 0 || contentCount.dodgyArchives != 0 || contentCount.hashes != 0)"
        [class.fa-deselect]="!showWord"
        [class.hide]="showSearch"
        (click)="maskClick('word')"
        class="fa fa-file-word-o fa-lg"
        pTooltip="Mask for Word content"
        escape="false"
        showDelay="750"
        tooltipPosition="bottom">
          &nbsp;
      </span>

      <!-- excel mask -->
      <span
        *ngIf="contentCount.excel != 0 && (contentCount.word != 0 || contentCount.powerpoint != 0 || contentCount.images != 0 || contentCount.pdfs != 0 || contentCount.dodgyArchives != 0 || contentCount.hashes != 0)"
        [class.fa-deselect]="!showExcel"
        [class.hide]="showSearch"
        (click)="maskClick('excel')"
        class="fa fa-file-excel-o fa-lg"
        pTooltip="Mask for Excel content"
        escape="false"
        showDelay="750"
        tooltipPosition="bottom">
          &nbsp;
      </span>

      <!-- powerpoint mask -->
      <span
        *ngIf="contentCount.powerpoint != 0 && (contentCount.word != 0 || contentCount.excel != 0 || contentCount.images != 0 || contentCount.pdfs != 0 || contentCount.dodgyArchives != 0 || contentCount.hashes != 0)"
        [class.fa-deselect]="!showPowerpoint"
        [class.hide]="showSearch"
        (click)="maskClick('powerpoint')"
        class="fa fa-file-powerpoint-o fa-lg"
        pTooltip="Mask for PowerPoint content"
        escape="false"
        showDelay="750"
        tooltipPosition="bottom">
          &nbsp;
      </span>

      <!-- dodgy archive mask -->
      <span
        *ngIf="contentCount.dodgyArchives != 0 && !showFromArchivesOnly && (contentCount.pdfs != 0 || contentCount.excel != 0 || contentCount.powerpoint != 0 || contentCount.word != 0 || contentCount.images != 0 || contentCount.hashes != 0)"
        [class.fa-deselect]="!showDodgyArchives"
        [class.hide]="showSearch"
        (click)="maskClick('dodgy')"
        class="fa fa-lock fa-lg"
        pTooltip="Mask for dodgy archive content"
        escape="false"
        showdelay="750"
        tooltipPosition="bottom">
          &nbsp;
      </span>

      <!-- hash mask -->
      <span
        *ngIf="contentCount.hashes != 0 && (contentCount.pdfs != 0 || contentCount.excel != 0 || contentCount.powerpoint != 0 || contentCount.word != 0 || contentCount.dodgyArchives != 0 || contentCount.images != 0)"
        [class.fa-deselect]="!showHashes"
        [class.hide]="showSearch"
        (click)="maskClick('hash')"
        class="fa fa-hashtag fa-lg"
        pTooltip="Mask for matched hash content"
        escape="false"
        showDelay="750"
        tooltipPosition="bottom">
          &nbsp;
      </span>

      <!-- only from archives mask -->
      <span
        *ngIf="contentCount.fromArchives != 0 && contentCount.fromArchives != contentCount.total"
        [class.fa-deselect]="!showFromArchivesOnly"
        [class.hide]="showSearch"
        (click)="maskClick('archivesOnly')"
        class="fa fa-file-archive-o fa-lg"
        pTooltip="Only show content extracted from archives"
        escape="false"
        showDelay="750"
        tooltipPosition="bottom">
          &nbsp;
      </span>

      <!--Search Button-->
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

      <span
        *ngIf="contentCount.pdfs != 0 || contentCount.excel != 0 || contentCount.powerpoint != 0 || contentCount.word != 0"
        class="fa fa-search fa-lg"
        (click)="toggleSearch()">
      </span>

      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

    </ng-container>

    <!--Preferences, Accounts, Help, and Logout Buttons-->
    <span
      (click)="preferencesButtonClick()"
      class="fa fa-cog fa-lg"
      pTooltip="Global preferences"
      escape="false"
      showDelay="750"
      tooltipPosition="bottom">
    </span>
    
    &nbsp;

    <span
      (click)="accountsButtonClick()"
      class="fa fa-users fa-lg"
      pTooltip="Manage users"
      escape="false"
      showDelay="750"
      tooltipPosition="bottom">
    </span>
    
    &nbsp;

    <span
      (click)="helpButtonClick()"
      class="fa fa-question fa-lg"
      pTooltip="About Atomic Fishbowl"
      escape="false"
      showDelay="750"
      tooltipPosition="bottom">
    </span>
    
    &nbsp;

    <span
      (click)="onLogoutButtonClick()"
      class="fa fa-sign-out fa-lg"
      pTooltip="Logout"
      escape="false"
      showDelay="750"
      tooltipPosition="left">
    </span>
    
    &nbsp;&nbsp;

  </span>

</div>
<!-- end toolbar -->



<!--Search Bar Dropdown-->
<div
  *ngIf="showSearch"
  class="noselect toolbarSearchDropdown"
  (keydown.escape)="toggleSearch()">

  <input
    #searchBox
    type="text"
    name="searchTerms"
    [(ngModel)]="searchTerms"
    (ngModelChange)="searchTermsUpdate()">
    
  &nbsp;&nbsp;
  
  <span
    [class.fa-deselect]="caseSensitive"
    class="fa fa-text-height"
    (click)="toggleCaseSensitivity()">
  </span>
  
  &nbsp;&nbsp;

  <span
    class="fa fa-times"
    (click)="toggleSearch()">
  </span>

</div>
